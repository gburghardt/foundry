/*! foundry 2014-05-16 */
;var Oxydizr={};Oxydizr.FrontController=function FrontController(){this.events={};this.controllers={};this.handleEvent=this.handleEvent.bind(this);this.handleEnterpress=this.handleEnterpress.bind(this)};Oxydizr.FrontController.prototype={catchErrors:false,controllers:null,element:null,errorHandler:{handleError:function(b,a,d,c,g,f,e){console.error(b);console.log({controller:a,event:d,element:c,params:g,action:f,controllerId:e});return true}},events:null,constructor:Oxydizr.FrontController,destructor:function(){if(this.controllers){for(var b in this.controllers){if(this.controllers.hasOwnProperty(b)){this.unregisterController(this.controllers[b]);this.controllers[b]=null}}this.controllers=null}if(this.events){for(var a in this.events){if(this.events.hasOwnProperty(a)){this._removeEvent(this.element,a,this.events[a])}}this.events=null}this.element=null},init:function(a){if(a){this.element=a}if(!this.element){throw new Error("Missing required argument: element")}this.registerEvents("click","submit");return this},_addEvent:function(b,a,c){if(!this.events[a]){this.events[a]=c;this._addEventListener(b,c.name,c.handler,c.capture)}},_addEventListener:function(c,b,d,a){c.addEventListener(b,d,a)},_createDelegateId:function(){var a=1000;return function(){return String(++a)}}(),_getActions:function(b){var a=b.getAttribute("data-actions");if(!a||/^\s*$/.test(a)){return[]}else{return a.replace(/^\s+|\s+$/g,"").split(/[.\s+]/g)}},_getMethodFromAction:function(a,c,b){var d=null;if(a[c]&&a[c].name===(b.__type||b.type)){d=c}else{if(a.handleAction){d="handleAction"}}return d},_getParams:function(c,b){var a=b.getAttribute("data-action-params");return(a)?JSON.parse(a):{}},handleEnterpress:function(a){if(a.keyCode===13){a.__type="enterpress";this.handleEvent(a)}},_handleError:function(b,a,f,e,d,c,g){if(a&&a.handleActionError){return a.handleActionError(b,d,c,g,e,a,f)}else{if(this.errorHandler){return this.errorHandler.handleActionError(b,a,d,c,g,e,f)}}return false},handleEvent:function(a){this._patchEvent(a);this._propagateEvent(a.target,a);this._unpatchEvent(a)},_invokeAction:function(f,e,d,c,g){var a=this.controllers[f]||null,h=null;if(!a){d.stop();throw new Error("No controller registered for "+f)}else{if(h=this._getMethodFromAction(a,e,d)){if(this.catchErrors){try{a[h](d,c,g,e)}catch(b){d.stop();if(!this._handleError(b,a,f,e,d,c,g)){throw b}}}else{a[h](d,c,g,e)}}}},_patchEvent:function(a){a.__isStopped=false;a.__stopPropagation=a.stopPropagation;a.stopPropagation=function(){a.__stopPropagation();this.__isStopped=true};a.__stop=a.stop||null;a.stop=function(){if(this.__stop){this.__stop()}this.preventDefault();this.stopPropagation()}},_propagateEvent:function(h,a){var g=this._getActions(h),e=this._getParams(a,h),c,f,d;for(var j=0,b=g.length;j<b;j+=2){c=g[j];f=g[j+1];d=e[c+"."+f]||{};this._invokeAction(c,f,a,h,d);if(a.__isStopped){break}}if(a.__isStopped||h===this.element){}else{if(h.parentNode){this._propagateEvent(h.parentNode,a)}}},_registerEvent:function(a){var b={name:a,handler:this.handleEvent,capture:false};if(a==="enterpress"){b.name="keypress";b.handler=this.handleEnterpress}else{if(a==="focus"||a==="blur"){b.capture=true}}this._addEvent(this.element,a,b)},registerEvents:function(){for(var a=0,b=arguments.length;a<b;a++){this._registerEvent(arguments[a])}return this},registerController:function(a){var b=a.controllerId||(a.controllerId=this._createDelegateId());if(this.controllers[b]){throw new Error("Cannot register duplicate delegate Id: "+b)}this.controllers[b]=a;a.onControllerRegistered(this,b);return b},_removeEvent:function(b,a,c){if(this.events[a]){this._removeEventListener(b,c.name,c.handler,c.capture);this.events[a]=this.events[a].handler=null}},_removeEventListener:function(c,b,d,a){c.removeEventListener(b,d,a)},_unpatchEvent:function(a){a.stopPropagation=a.__stopPropagation;a.stop=a.__stop||null;a.__stop=a.__stopPropagation=a.__isStopped=null},unregisterController:function(a){var b=a.controllerId;if(!b||!this.controllers[a.controllerId]){return false}else{this.controllers[a.controllerId]=null;delete this.controllers[a.controllerId];a.onControllerUnregistered(this);return true}}};this.Hypodermic={};(function(a){var e=["applicationCache","console","document","localStorage","location","navigator","screen","sessionStorage"],c={global:a};for(var f=0,h,b=e.length;f<b;f++){h=e[f];if(h in a){try{c[h]=a[h]}catch(g){var j="Cannot seed global singletons with "+h+". Failed with error: "+g.message;if(a.console&&a.console.warn){a.console.warn(j)}else{setTimeout(function(){throw j},500)}}}}function d(k){if(!k){throw new Error("Missing required argument: configs")}var m=new Hypodermic.DependencyResolver(this),l=new Hypodermic.ObjectFactory(this,m),i=Object.create(c);i.container=this;this.resolve=function(q,o){var n=null,p=k[q],r={};if(i[q]){n=i[q]}else{if(!p){if(o){throw new Error("No configuration found for "+q)}}else{if(p.template){throw new Error("Cannot create resolve template config: "+q)}else{if(p.factory){n=l.createInstanceFromFactory(p)}else{n=l.createInstance(p,p.constructorArgs)}if(p.singleton){i[q]=n}m.injectDependencies(n,p,r);while(p=k[p.parent]){m.injectDependencies(n,p,r)}}}}return n}}a.Hypodermic.Container=d})(this);(function(c){function f(g){this.container=g}f.prototype={container:null,constructor:f,findDependency:function(i){var g=null,h;if(a(i)){g=this.container.resolve(i,true)}else{if("value" in i){g=i.value}else{throw new Error("No dependency value found. Missing one of 'id', 'value' or 'factory'")}}return g},injectDependencies:function(g,i,l){if(!i.properties){return}var k=i.properties,j,h,m;for(j in k){if(k.hasOwnProperty(j)&&!l[j]){m="set"+b(j);h=this.findDependency(k[j]);if(e(g[m])){g[m](h)}else{g[j]=h}l[j]=true}}}};c.Hypodermic.DependencyResolver=f;var d=Object.prototype.toString;function b(g){return g.charAt(0).toUpperCase()+g.substring(1,g.length)}function e(g){return d.call(g)==="[object Function]"}function a(g){return d.call(g)==="[object String]"}})(this);(function(global){function ObjectFactory(container,dependencyResolver){this.container=container;this.dependencyResolver=dependencyResolver}ObjectFactory.prototype={container:null,dependencyResolver:null,constructor:ObjectFactory,createInstance:function(config,constructorDependencies){if(!config.type){throw new Error("Missing required argument: config.type")}var Klass=this._getClassReference(config.type),instance=null,args=null;if(!Klass){throw new Error("Class "+config.type+" not found.")}else{if(Klass.constructor===Function){instance=Object.create(Klass.prototype);if(constructorDependencies){args=this._getConstructorArgs(constructorDependencies);Klass.apply(instance,args)}else{Klass.call(instance)}}else{instance=Klass}}return instance},createInstanceFromFactory:function(config){if(!config.factory.id){throw new Error("Missing required argument: config.factory.id")}var factoryInfo=config.factory,factory=this.container.resolve(factoryInfo.id,true),method=factoryInfo.method||"createInstance",args=[],dependency,i,length;if(factoryInfo.args&&factoryInfo.args.length){for(i=0,length=factoryInfo.args.length;i<length;i++){args.push(this.dependencyResolver.findDependency(factoryInfo.args[i]))}}else{args.push(factoryInfo.type)}if(!factory[method]){throw new Error("No method called "+method+" exists on the factory object registered as "+factoryInfo.id)}dependency=factory[method].apply(factory,args);return dependency},_getClassReference:function(className){var Klass=_classCache[className]||null;if(!Klass&&/^[a-zA-Z][\w.$]+$/.test(className)){try{Klass=global.eval(className)}catch(error){Klass=null}}if(Klass){_classCache[className]=Klass}return Klass},_getConstructorArgs:function(dependencies){var args=[];for(var i=0,length=dependencies.length;i<length;i++){args.push(this.dependencyResolver.findDependency(dependencies[i]))}return args}};global.Hypodermic.ObjectFactory=ObjectFactory;var _classCache={};var conditionalClasses=["Array","Boolean","Date","document","DocumentFragment","DOMParser","Error","FileReader","Function","location","navigator","Number","Object","RegExp","String","XMLHttpRequest"];var i,length,x;for(i=0,length=conditionalClasses.length;i<length;i++){x=conditionalClasses[i];if(global[x]!==undefined){_classCache[x]=global[x]}}})(this);
/*! module-manager 2014-05-16 */
;
/*! module-manager 2014-05-16 */
;this.Module=this.Module||{};(function(){function Factory(){}Factory.prototype={objectFactory:null,constructor:Factory,destructor:function(){this.objectFactory=null},getInstance:function(type){var instance=null,Klass=null;if(this.objectFactory){instance=this.objectFactory.getInstance(type)}if(!instance){if(/^[a-zA-Z][a-zA-Z0-9.]+[a-zA-Z0-9]$/.test(type)){try{Klass=eval(type)}catch(error){throw new Error("Class name "+type+" does not exist")}if(!Klass){throw new Error("Class name "+type+" does not exist")}else{if(typeof Klass!=="function"){throw new Error("Class name "+type+" is not a constructor function")}}instance=new Klass()}else{throw new Error("Cannot instantiate invalid type: "+type)}}return instance}};Module.Factory=Factory})();(function(){function a(){}a.prototype={baseClassName:"module",defaultModule:null,defaultModuleFocused:false,moduleObserver:{onModuleCreated:function(c,b,d){},onSubModuleCreated:function(c,b,d){},onModuleRegistered:function(b,c){},onModuleUnregistered:function(b){}},provider:null,registry:null,groups:null,constructor:Module.Manager,destructor:function(b){if(Module.manager===this){Module.manager=null}if(this.registry){this._destroyRegistry(b)}if(this.groups){this._destroyGroups()}if(this.provider){if(b){this.provider.destructor()}this.provider=null}if(this.lazyLoader){this.lazyLoader.destructor();this.lazyLoader=null}},_destroyGroups:function(){var c,e,b,d;for(c in this.groups){if(this.groups.hasOwnProperty(c)){e=this.groups[c];for(b=0,d=e.length;b<d;b++){e[b]=null}this.groups[c]=null}}this.groups=null},_destroyRegistry:function(d){var b,c;for(b in this.registry){if(this.registry.hasOwnProperty(b)){c=this.registry[b];this.moduleObserver.onModuleUnregistered(c.module);if(d){c.module.destructor(true)}c.module=null;this.registry[b]=null}}this.registry=null},init:function(){this.provider=this.provider||new Module.Provider();this.provider.factory=this.provider.factory||new Module.Factory();this.provider.manager=this;this.provider.moduleObserver=this.moduleObserver;this.registry=this.registry||{};this.groups=this.groups||{};Module.manager=this;return this},eagerLoadModules:function(d){var c=d.querySelectorAll("[data-modules]"),b=0;for(b;b<c.length;b++){this.createModules(c[b])}c=null;return this},lazyLoadModules:function(c,b){this.lazyLoader=(this.lazyLoader||new Module.LazyLoader()).setManager(this).setElement(c).setOptions(b).init();c=b=null;return this},createModule:function(d,f,b,e){var c=this.provider.createModule(d,f,b);if(e){this.registerModule(f,c)}d=b=null;return c},createModules:function(d,e){if(!d){throw new Error("Missing required argument: element")}else{if(!e&&d.getAttribute("data-module-lazyload")){return[]}else{if(d.getAttribute("data-module-property")){return[]}}}var b=new Module.MetaData(d),c=[];if(b.mediaMatches()){this.provider.createModules(b,function(h,g,i,f){c.push(h);this.registerModule(i,h);h.init()},this);this.markModulesCreated(d,b)}b=d=null;return c},focusDefaultModule:function(b){if(this.defaultModule&&!this.defaultModuleFocused){this.defaultModuleFocused=true;this.defaultModule.focus(b)}},initModuleInContainer:function(e,b,d,k,h,c){var g=new Date();var j={guid:c.guid,createdAt:g,timestamp:g.getTime(),controllerId:c.controllerId},i;if(d.renderData){for(i in d.renderData){if(d.renderData.hasOwnProperty(i)){j[i]=d.renderData[i]}}}var f=k.innerHTML.replace(/#\{([-.\w]+)\}/g,function(l,m){return j[m]||""});e.className+=(" "+this.baseClassName+" "+d.className).replace(/\s{2,}/g," ");e.innerHTML=f;if(d.insert==="top"&&b.firstChild){b.insertBefore(e,b.firstChild)}else{b.appendChild(e)}this.registerModule(h,c);c.init();if(d.autoFocus){c.focus(!!d.autoFocusAnything)}},markModulesCreated:function(c,b){c.setAttribute("data-modules-created",b.types.join(" "));c.removeAttribute("data-modules");c=b=null},registerModule:function(c,b){if(b.guid===undefined||b.guid===null){throw new Error("Cannot register module "+c+" without a guid property")}else{if(this.registry[b.guid]){throw new Error("Module "+b.guid+" has already been registered")}}this.registry[b.guid]={module:b,type:c};if(!this.groups[c]){this.groups[c]=[]}this.groups[c].push(b);this.moduleObserver.onModuleRegistered(b,c);b=null},unregisterModule:function(e){if(!e.guid||!this.registry[e.guid]){e=null;return false}var c=e.guid,f=this.registry[c].type,h=this.groups[f],b=false;this.registry[c].module=null;this.registry[c]=null;delete this.registry[c];if(h){for(var d=0,g=h.length;d<g;d++){if(h[d]===e){h.splice(d,1);b=true;this.moduleObserver.onModuleUnregistered(e);break}}}e=h=null;return b},setDefaultModule:function(b){if(!this.defaultModule){this.defaultModule=b}b=null}};Module.Manager=a})();(function(b){function a(c){this.options=null;this.types=[];if(c){this.setElement(c)}}a.prototype={element:null,media:null,options:null,types:null,constructor:a,forEach:function(j,f){var e=0,h=this.types.length,c,g,d;if(h===1){j.call(f,this.element,this.types[0],this.options,0,this)}else{for(e;e<h;++e){g=this.types[e];d=this.options[g]||{};c=j.call(f,this.element,g,d,e,this);if(c===false){break}}}},mediaMatches:function(){if(!b.matchMedia){throw new Error("This browser does not support JavaScript media queries. Please include a polyfill (https://github.com/paulirish/matchMedia.js)")}return this.media===null||b.matchMedia(this.media).matches},setElement:function(e){this.element=e;var d=e.getAttribute("data-modules"),c=e.getAttribute("data-module-options");if(!d){throw new Error("Missing required attribute data-modules on "+e.nodeName+"."+e.className.split(/\s+/g).join(".")+"#"+e.id)}this.types=d.replace(/^\s+|\s+$/g,"").split(/\s+/g);this.options=c?JSON.parse(c):{};this.media=e.getAttribute("data-module-media")}};b.Module.MetaData=a})(this);(function(){function a(){}a.prototype={factory:null,manager:null,moduleObserver:null,subModulesEnabled:true,constructor:a,destructor:function(b){if(b&&this.factory){this.factory.destructor()}this.factory=this.manager=null},_createModuleClass:function(b){return"module "+b.charAt(0).toLowerCase()+b.slice(1,b.length).replace(/(\.[A-Z])/g,function(d,c){return"-"+c.replace(/\./g,"").toLowerCase()}).replace(/Module$/,"").replace(/^\s+|\s+$/g,"")},createModule:function(d,f,b){var c=this.factory.getInstance(f);var e=this._createModuleClass(f);d.className+=d.className?" "+e:e;c.setElement(d);c.setOptions(b);if(b.defaultModule){this.manager.setDefaultModule(c)}this.moduleObserver.onModuleCreated(c,d,f);if(this.subModulesEnabled&&!b.subModulesDisabled){this._createSubModules(c)}return c},createModules:function(b,f,e){var c=[],d,f=f||function(){};b.forEach(function(h,i,g){d=this.createModule(h,i,g);c.push(d);f.call(e,d,h,i,g)},this);f=e=d=null;return c},_createSubModules:function(f){var e=f.element.getElementsByTagName("*"),g=e.length,d=0,c,b;for(d;d<g;d++){c=e[d];b=c.getAttribute("data-module-property");if(b){this._createSubModuleProperty(f,b,c)}}},_createSubModuleProperty:function(f,d,e){var b=new Module.MetaData(e),c;if(b.types.length>1){throw new Error("Sub module elements cannot have more than one type specified in data-modules")}c=this.createModule(e,b.types[0],b.options);this.moduleObserver.onSubModuleCreated(c,e,b.types[0]);c.init();if(f[d]===null){f[d]=c}else{if(f[d] instanceof Array){if(!f.hasOwnProperty(d)){f[d]=[]}f[d].push(c)}else{throw new Error("Cannot create sub module property '"+d+"'. Property is neither null nor an Array on the parent module.")}}this.manager.markModulesCreated(e,b);c=b=e=null}};Module.Provider=a})();
/*! module-manager 2014-05-16 */
;Module.FrontControllerModuleObserver=function FrontControllerModuleObserver(a){this.frontController=a||null};Module.FrontControllerModuleObserver.prototype={frontController:null,constructor:Module.FrontControllerModuleObserver,_ensureControllerId:function(a){a.controllerId=a.controllerId||a.options.controllerId||a.guid},onModuleCreated:function(b,a,c){this._ensureControllerId(b)},onSubModuleCreated:function(b,a,c){this.frontController.registerController(b)},onModuleRegistered:function(a,b){this.frontController.registerController(a)},onModuleUnregistered:function(a){this.frontController.unregisterController(a)}};
/*! module-manager 2014-05-16 */
;
/*! browser-viewport 2014-05-16 */
;function Viewport(a){if(!a){throw new Error("Missing required argument: window")}var m=this,d={"resize:complete":{type:"resize",handle:null,useCapture:false,bound:false,listeners:[],element:a},"scroll:complete":{type:"scroll",handle:null,useCapture:false,bound:false,listeners:[],element:a.document}},l=20,b=a.orientation||this.height>this.width?0:90;_orientationEvent={mql:a.matchMedia?a.matchMedia("(orientation: portrait)"):null,regex:/^orientation:\w+$/i,listeners:{count:0,"orientation:change":[],"orientation:portrait":[],"orientation:landscape":[]},test:function(n){return this.regex.test(n)&&!!this.listeners[n]}},_resizeTimer=null,_resizeTimeout=300,_scrollTimer=null,_scrollTimeout=300,createAccessor=function(o,n,p){Object.defineProperty(m,o,{enumerable:true,get:n,set:p})},createGetter=function(o,n){Object.defineProperty(m,o,{enumerable:true,get:n})};createGetter("bottom",function(){return a.pageYOffset+a.innerHeight});createGetter("document",function(){return a.document});createAccessor("eventListenerDelay",function(){return l},function(n){l=n});createGetter("height",function(){return a.innerHeight});createGetter("left",function(){return a.pageXOffset});createGetter("location",function(){return a.location});createGetter("orientation",function(){return b});createAccessor("resizeTimeout",function(){return _resizeTimeout},function(n){_resizeTimeout=n});createGetter("right",function(){return a.pageXOffset+a.innerWidth});createGetter("screen",function(){return a.screen});createAccessor("scrollTimeout",function(){return _scrollTimeout},function(n){_scrollTimeout=n});createGetter("top",function(){return a.pageYOffset});createGetter("width",function(){return a.innerWidth});createGetter("window",function(){return a});this.destructor=function(){if(_resizeTimer){a.clearTimeout(_resizeTimer);_resizeTimer=null}if(_scrollTimer){a.clearTimeout(_scrollTimer);_scrollTimer=null}f(d["resize:complete"]);f(d["scroll:complete"]);m=d=a=null};this.addEventListener=function(o,q){o=o.toLowerCase();var p,n;if(_orientationEvent.test(o)){n=_orientationEvent.listeners;if(!n.count&&_orientationEvent.mql){_orientationEvent.mql.addListener(j)}n[o].push(q);n.count++}else{if(p=d[o]){c(p);p.listeners.push(q)}}};this.removeEventListener=function(p,r){p=p.toLowerCase();var q,n,o;if(_orientationEvent.test(p)){o=_orientationEvent.listeners[p];n=o.indexOf(r);if(n>-1){o.splice(n,1);if(--o.count===0&&_orientationEvent.mql){_orientationEvent.mql.removeListener(j)}}}else{if(d[p]){q=d[p];n=q.listeners.indexOf(r);if(n>-1){q.listeners.splice(n,1);if(!q.listeners.length){f(q)}}}}};var c=function(n){if(n.bound){return}n.element.addEventListener(n.type,n.handle,n.useCapture);n.bound=true},g=function(){k(d["resize:complete"].listeners)},e=function(){k(d["scroll:complete"].listeners)},k=function(o){if(!o.length){return}var p=function(){if(++n===o.length||o[n](m)===false){return}a.setTimeout(p,l)},n=-1;p()},j=function(n){b=n.matches?0:a.orientation||90;k(_orientationEvent.listeners["orientation:change"]);if(n.matches){k(_orientationEvent.listeners["orientation:portrait"])}else{k(_orientationEvent.listeners["orientation:landscape"])}},h=function(n){if(_resizeTimer){a.clearTimeout(_resizeTimer);_resizeTimer=null}_resizeTimer=a.setTimeout(g,_resizeTimeout)},i=function(n){if(_scrollTimer){a.clearTimeout(_scrollTimer);_scrollTimer=null}_scrollTimer=a.setTimeout(e,_scrollTimeout)},f=function(n){if(!n.bound){return}n.element.removeEventListener(n.type,n.handle,n.useCapture);n.bound=false};d["resize:complete"].handle=h;d["scroll:complete"].handle=i}Viewport.prototype={constructor:Viewport,contains:function(a){var c=this.getElementPosition(a),b=this.getPosition();if(c.left<b.right&&c.right>b.left&&c.top<b.bottom&&c.bottom>b.top){return true}else{return false}},getElementPosition:function(a){var b={left:a.offsetLeft,top:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight};while(a=a.offsetParent){b.left+=a.offsetLeft;b.top+=a.offsetTop}b.right=b.left+b.width;b.bottom=b.top+b.height;return b},getPosition:function(){return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.right,bottom:this.bottom}},is:function(a){return this===a||this.window===a||this.screen===a||this.document===a},matchMedia:function(a){return this.window.matchMedia?this.window.matchMedia(a):{matches:false}},querySelector:function(a,d,c){var b=null;this.querySelectorAll(a,function(e){b=e;return false});return b},querySelectorAll:function(b,h,e){h=h||function(){};e=e||this;var g=this.document.body.querySelectorAll(b),d=0,a,f=[],c;for(d;d<g.length;d++){c=g[d];if(this.contains(c)){f.push(c);if(a!==false){a=h.call(e,c,d,this)}}}return f},toString:function(){return"[object Viewport: "+this.location+"]"}};(function(){function a(){this.handleScrollComplete=this.handleScrollComplete.bind(this);this.handleResizeComplete=this.handleResizeComplete.bind(this);this.handleMouseover=this.handleMouseover.bind(this);this.options={resizeTimeout:0,scrollTimeout:0}}a.prototype={document:null,element:null,manager:null,options:null,viewport:null,window:null,constructor:a,destructor:function(){if(this.viewport){this.viewport.removeEventListener("scroll:complete",this.handleScrollComplete);this.viewport.removeEventListener("resize:complete",this.handleResizeComplete);this.viewport=null}if(this.element){this.element.removeEventListener("mouseover",this.handleMouseover,false);this.element=null}this.document=this.window=this.options=this.manager=null},init:function(){if(!this.viewport){this.setViewport(new Viewport(window))}if(this.options.resizeTimeout>0){this.viewport.resizeTimeout=this.options.resizeTimeout}if(this.options.scrollTimeout>0){this.viewport.scrollTimeout=this.options.scrollTimeout}this.viewport.addEventListener("scroll:complete",this.handleScrollComplete);this.viewport.addEventListener("resize:complete",this.handleResizeComplete);this.element.addEventListener("mouseover",this.handleMouseover,false);this._initModulesInViewport();return this},handleMouseover:function(b){b=b||window.event;b.target=b.target||b.srcElement;if(b.target.getAttribute("data-module-lazyload")){this._lazyLoadModules(b.target,b.type)}},handleScrollComplete:function(b){this._initModulesInViewport()},handleResizeComplete:function(b){this._initModulesInViewport()},_initModulesInViewport:function(){this.viewport.querySelectorAll("[data-module-lazyload]",function(b){this._lazyLoadModules(b,"scrollto")},this)},_lazyLoadModules:function(c,d){var b=c.getAttribute("data-module-lazyload");if(b==="any"||new RegExp(d).test(b)){if(this.manager.createModules(c,true).length){c.removeAttribute("data-module-lazyload");c.setAttribute("data-module-lazyloaded",b)}}},setElement:function(b){this.element=b;this.document=b.ownerDocument;this.window=this.document.defaultView;return this},setManager:function(b){this.manager=b;return this},setOptions:function(c){if(c){for(var b in c){if(c.hasOwnProperty(b)){this.options[b]=c[b]}}}return this},setViewport:function(b){this.viewport=b;this.setElement(b.document.documentElement);return this}};Module.LazyLoader=a})();var Foundry={version:"0.1.1"};Foundry.run=function(f){f=f||function(){};var c={application:{type:"Foundry.Application",singleton:true,properties:{container:"container",dispatcher:"eventDispatcher",frontController:"frontController",moduleManager:"moduleManager"}},viewport:{type:"Viewport",singleton:true,constructorArgs:["global"]},frontController:{type:"Oxydizr.FrontController",singleton:true},eventDispatcher:{type:"Beacon.Dispatcher",singleton:true},objectFactory:{type:"Foundry.ModuleFactory",singleton:true,properties:{container:"container"}},moduleFactory:{type:"Module.Factory",singleton:true,properties:{objectFactory:"objectFactory"}},moduleProvider:{type:"Module.Provider",singleton:true,properties:{factory:"moduleFactory"}},moduleManager:{type:"Module.Manager",singleton:true,properties:{provider:"moduleProvider",moduleObserver:"moduleObserver",lazyLoader:"moduleLazyLoader"}},moduleObserver:{type:"Module.FrontControllerModuleObserver",properties:{frontController:"frontController"}},moduleLazyLoader:{type:"Module.LazyLoader",singleton:true,properties:{manager:"moduleManager",viewport:"viewport"}},module:{template:true,properties:{elementStore:"elementStore",eventDispatcher:"eventDispatcher"}},elementStore:{type:"ElementStore"},merge:function(h){for(var g in h){if(h.hasOwnProperty(g)){this[g]=h[g]}}return this}};var b={autoInit:true},d=f(c,b)||document.documentElement,a=new Hypodermic.Container(c),e=a.resolve("application");if(b.autoInit){e.init(d,b)}else{e.setElement(d);e.setOptions(b)}return e};Foundry.Application=function(){this.options={eagerLoadModules:true,focusAnythingInDefaultModule:false,handleActionErrors:true,handleApplicationErrors:true,lazyLoadModules:false,subModulesDisabled:false}};Foundry.Application.prototype={dispatcher:null,document:null,element:null,errorHandler:null,eventsController:null,frontController:null,moduleManager:null,newModuleController:null,options:null,window:null,constructor:Foundry.Application,init:function(c,b){if(c){this.setElement(c)}if(b){this.setOptions(b)}this._initErrorHandling();try{this.frontController.init(this.element);this._initEventsController();this._initNewModuleController();this._initModuleManager();this.dispatcher.publish("application.ready",this)}catch(a){if(!this.errorHandler||!this.errorHandler.handleError(a)){throw a}}return this},_initErrorHandling:function(){if(this.options.handleApplicationErrors){this.errorHandler=this.errorHandler||new Foundry.ErrorHandler();this.errorHandler.init(this,this.window);if(!this.frontController.errorHandler&&this.options.handleActionErrors){this.frontController.errorHandler=this.errorHandler}}},_initEventsController:function(){this.eventsController=this.eventsController||new Foundry.ApplicationEventsController(this.dispatcher);this.frontController.registerController(this.eventsController)},_initModuleManager:function(){this.moduleManager.init();if(this.options.eagerLoadModules){this.moduleManager.eagerLoadModules(this.element)}if(this.options.lazyLoadModules){this.moduleManager.lazyLoadModules(this.element)}this.moduleManager.focusDefaultModule(this.options.focusAnythingInDefaultModule)},_initNewModuleController:function(){var a=this.newModuleController||new Foundry.NewModuleController();a.dispatcher=this.dispatcher;a.document=this.document;a.frontController=this.frontController;a.moduleManager=this.moduleManager;a.init();this.newModuleController=a},destructor:function(){this.dispatcher.publish("application.destroy",this);this.moduleManager.destructor(true);this.errorHandler.destructor();this.eventsController.destructor();this.newModuleController.destructor();this.frontController.destructor();this.dispatcher.destructor();this.newModuleController=this.eventsController=this.dispatcher=this.frontController=this.moduleManager=this.errorHandler=this.element=this.document=this.window=this.logger=this.options=null},setElement:function(a){this.element=a;this.document=a.ownerDocument;this.window=this.document.defaultView},setOptions:function(a){for(var b in a){if(a.hasOwnProperty(b)){this.options[b]=a[b]}}}};Foundry.ApplicationEventsController=function(a){this.dispatcher=a};Foundry.ApplicationEventsController.prototype={controllerId:"events",dispatcher:null,frontController:null,constructor:Foundry.ApplicationEventsController,destructor:function(){if(this.frontController){this.frontController.unregisterController(this)}this.dispatcher=this.frontController=null},onControllerRegistered:function(b,a){this.frontController=b},onControllerUnregistered:function(a){},publishEvent:function click(b,a,c){if(!c.event){throw new Error("Missing required argument params.event")}b.stop();this.dispatcher.publish(c.event,a,c.data||{})}};Foundry.ErrorHandler=function(){};Foundry.ErrorHandler.prototype={application:null,logger:window.console||null,window:null,constructor:Foundry.ErrorHandler,destructor:function(){if(this.window){this.window.onerror=null}this.application=this.logger=this.window=null},init:function(a,b){this.application=a;this.window=b;this.window.onerror=this.handleError.bind(this)},_getErrorObject:function(errorMessage){var info=errorMessage.match(/^(([A-Za-z_][A-Za-z0-9._]*):)?(.+$)/),error=null,className,message,Klass;if(!info){error=new Error(message)}else{className=info[2]||"Error";message=(info[3]||errorMessage).replace(/^\s+|\s+$/g,"");if(/^[A-Za-z_][A-Za-z0-9._]*$/.test(className)){try{Klass=eval(className);error=new Klass(message)}catch(error){throw new Error("Class '"+className+"' is either not found or not an object constructor function")}}else{error=new Error(message)}}return error},handleActionError:function(b,d,c,g,f,a,e){if(this.logger){this.logger.error(b);this.logger.debug({error:b,event:d,element:c,params:g,action:f,controller:a,controllerId:e})}else{throw b}},handleError:function(b){var a=typeof b==="string"?this._getErrorObject(b):b;return this._handleError(a)},_handleError:function(a){if(this.logger){this.logger.error(a);return true}return false}};Foundry.ModuleFactory=function ModuleFactory(){};Foundry.ModuleFactory.prototype={container:null,constructor:Foundry.ModuleFactory,destructor:function(){this.container=null},getInstance:function(a){return this.container.resolve(a)}};Foundry.ModuleObserver=function(a){this.frontController=a||null};Foundry.ModuleObserver.prototype={frontController:null,constructor:Foundry.ModuleObserver,destructor:function(){this.frontController=null},onModuleCreated:function(b,a,c){b.controllerId=b.options.controllerId||b.guid},onModuleRegistered:function(a,b){this.frontController.registerController(a)},onModuleUnregistered:function(a){this.frontController.unregisterController(a)}};Foundry.NewModuleController=function(){};Foundry.NewModuleController.prototype={controllerId:"newModules",dispatcher:null,document:null,frontController:null,moduleManager:null,constructor:Foundry.NewModuleController,destructor:function(){if(this.dispatcher){this.dispatcher.unsubscribe(this)}if(this.frontController){this.frontController.unregisterController(this)}this.dispatcher=this.document=this.moduleManager=this.frontController=null},init:function(){this.dispatcher.subscribe(this.controllerId+".createModule",this,"handleCreateModule");this.frontController.registerController(this)},createModule:function click(b,a,c){b.stop();this._createModuleFromConfig(c);b=a=c=null},_createModuleFromConfig:function(c){if(!c.module){throw new Error("Missing required config.module")}else{if(!c.module.type){throw new Error("Missing required config.module.type")}else{if(!c.module.template){throw new Error("Missing required config.module.template for type: "+c.module.type)}}}c.module.options=c.module.options||{};c.container=c.container||{};c.container.insert=c.container.insert||"top";c.element=c.element||{};c.element.tag=c.element.tag||"div";var e=null;var b=null;var a="script[data-template="+c.module.template+"]";var f=this.document.querySelector(a);var d=this.document.createElement(c.element.tag);if(!f){throw new Error("Failed to find new module template using selector: "+a)}if(c.container.selector){b=this.document.querySelector(c.container.selector)}else{b=this.document.getElementsByTagName("body")[0]}if(!b){throw new Error("Failed to find module container with selector: "+(c.container.selector||"body"))}e=this.moduleManager.createModule(d,c.module.type,c.module.options||{});this.moduleManager.initModuleInContainer(d,b,c.container,f,c.module.type,e);e.focus();d=f=c=b=null;return e},handleCreateModule:function(a){this._createModuleFromConfig(a.data);return false},onControllerRegistered:function(b,a){},onControllerUnregistered:function(a){}};