/*! foundry 2014-02-05 */
function Callbacks(a,b){a&&(this.context=a,this.types=b||{})}function ElementStore(){}function Hash(a){a&&this.merge(a)}function Reaper(){}!function(){function a(a){var b;if(a.self)for(b in a.self)a.self.hasOwnProperty(b)&&!this[b]&&(this[b]=a.self[b]);if(a.prototype)for(b in a.prototype)a.prototype.hasOwnProperty(b)&&!this.prototype[b]&&(this.prototype[b]=a.prototype[b]);if(a.includes){a.includes=a.includes instanceof Array?a.includes:[a.includes];for(var c=0,d=a.includes.length;d>c;c++)this.include(a.includes[c])}a.included&&a.included(this),a=null}function b(a){a=a||{};var b,d,e,f;f=c?function(){this.__proto__=f.prototype,f.__inheriting||this.initialize.apply(this,arguments)}:function(){f.__inheriting||this.initialize.apply(this,arguments)},f.__inheriting=!1;for(b in this)this.hasOwnProperty(b)&&(f[b]=this[b]);if(a.self)for(b in a.self)a.self.hasOwnProperty(b)&&(f[b]=a.self[b]);try{this.__inheriting=!0,f.prototype=new this,this.__inheriting=!1}catch(g){throw this.__inheriting=!1,g}if(c&&(f.prototype.__proto__=this.prototype),a.prototype)for(b in a.prototype)a.prototype.hasOwnProperty(b)&&(f.prototype[b]=a.prototype[b]);if(a.includes)for(a.includes=a.includes instanceof Array?a.includes:[a.includes],d=0,e=a.includes.length;e>d;d++)f.include(a.includes[d]);return f.prototype.initialize=f.prototype.initialize||function(){},f.prototype.constructor=f,a=null,f}var c=/msie/i.test(navigator.userAgent);Function.prototype.include||(Function.prototype.include=a),Function.prototype.extend||(Object.extend&&(Object._extend=b),Function.prototype.extend=b)}();var Cerealizer={_instances:{},objectFactory:null,_types:{},getInstance:function(a){if(this._types[a]){if(!this._instances[a]){var b;if(this.objectFactory){if(b=this.objectFactory.getInstance(a),!b)throw new Error("Could not get serializer instance from object factory for type: "+a)}else b=new this._types[a];this._instances[a]=b}return this._instances[a]}throw new Error("Cannot get instance for unregistered type: "+a)},registerType:function(a,b){for(var c=0,d=b.length;d>c;c++)this._types[b[c]]=a}};if(Cerealizer.Json=function(){},Cerealizer.Json.prototype={constructor:Cerealizer.Json,regex:/^[{\[]].*[}\]]$/g,deserialize:function(a){return JSON.parse(a)},serialize:function(a){return JSON.stringify(a)},test:function(a){return this.regex.test(a)},toString:function(){return"[object Cerealizer.Json]"}},!window.JSON)throw new Error("No native JSON parser was found. Consider using JSON2.js (https://github.com/douglascrockford/JSON-js)");if(Cerealizer.registerType(Cerealizer.Json,["json","text/json","application/json"]),Cerealizer.QueryString=function(){},Cerealizer.QueryString.prototype={constructor:Cerealizer.QueryString,hashNotation:!0,keysRegex:/[\[\].]+/,pairsRegex:/([^=&]+)=([^&]+)/g,regex:/([^=&]+)=([^&]+)/,_convert:function(a){return a="string"==typeof a?unescape(a):a,/^[-+0-9.]+$/.test(a)&&!isNaN(a)?Number(a):/^(true|false)$/.test(a)?"true"===a:"NaN"===a?0/0:a},_convertAndHydrate:function(a,b,c){c=this._convert(unescape(c)),this._isValid(c)&&(keys=b.replace(/]$/,"").split(this.keysRegex),this._hydrate(a,keys,c))},deserialize:function(a){var b=this,c={};return a.replace(/^\?/,"").replace(this.pairsRegex,function(a,d,e){if(/\[\]/.test(d))throw new Error("Cannot deserialize keys with empty array notation: "+d);b._convertAndHydrate(c,d,e)}),c},_hydrate:function(a,b,c){var d,e=a,f=0,g=b.length-1,h=unescape(b[b.length-1]);for(f;g>f;f++)d=unescape(b[f]),e.hasOwnProperty(d)||(e[d]={}),e=e[d];return e[h]=c,e=b=null,a},_isValid:function(a){if(null===a||void 0===a)return!1;var b=typeof a;return"number"===b?!isNaN(a):"string"===b||"boolean"===b?!0:!1},_isObject:function(a){return"[object Object]"===Object.prototype.toString.call(a)},serialize:function(a){var b=this.hashNotation?"[":".",c=this.hashNotation?"]":"",d="[",e="]",f=[];return this._serialize(a,f,"",b,c,d,e).join("&")},_serialize:function(a,b,c,d,e,f,g){var h,i,j,k=/^[0-9+]$/;for(var l in a)a.hasOwnProperty(l)&&(this._isObject(a[l])?(h=c?k.test(l)?c+f+l+g:c+d+l+e:l,this._serialize(a[l],b,h,d,e,f,g)):this._isValid(a[l])&&(i=c?k.test(l)?c+f+escape(l)+g:c+d+escape(l)+e:escape(l),j=escape(a[l]),b.push(i+"="+j)));return b},test:function(a){return this.regex.test(a)},toString:function(){return"[object Cerealizer.QueryString]"}},Cerealizer.registerType(Cerealizer.QueryString,["queryString","application/x-www-form-urlencoded","multipart/form-data"]),Cerealizer.Xml=function(){this.parser=this.constructor.getParser()},Cerealizer.Xml.getParser=function(){return window.DOMParser?new DOMParser:null},Cerealizer.Xml.prototype={constructor:Cerealizer.Xml,parser:null,regex:/^\s*<[a-zA-Z][a-zA-Z0-9:]*.*?<\/[a-zA-Z0-9:]+[a-zA-Z]>\s*$/,_deserializeMSIE:function(a){var b=new ActiveXObject("Microsoft.XMLDOM");return b.async=!1,b.loadXML(a),b},_deserializeStandard:function(a){return this.parser.parseFromString(a,"text/xml")},_escape:function(a){return String(a).replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},_isObject:function(a){return"[object Object]"===Object.prototype.toString.call(a)},serialize:function(a){var b=this._serialize(a,[]);return b.join("")},_serialize:function(a,b){for(var c in a)a.hasOwnProperty(c)&&(this._isObject(a[c])?(b.push("<"+c+">"),this._serialize(a[c],b),b.push("</"+c+">")):b.push("<"+c+">"+this._escape(a[c])+"</"+c+">"));return b},test:function(a){return this.regex.test(a)},toString:function(){return"[object Cerealizer.Xml]"}},window.DOMParser)Cerealizer.Xml.prototype.deserialize=Cerealizer.Xml.prototype._deserializeStandard;else{if(!window.ActiveXObject)throw new Error("No native XML parser could be found.");Cerealizer.Xml.prototype.deserialize=Cerealizer.Xml.prototype._deserializeMSIE}Cerealizer.registerType(Cerealizer.Xml,["xml","text/xml","application/xml"]),Callbacks.prototype={context:null,types:null,destructor:function(){this.context=this.types=null},add:function(a,b){return this.types[a]||(this.types[a]=[]),this.types[a].push(b),this},execute:function(a){if(!this.types[a])return!0;var b,c=Array.prototype.slice.call(arguments,1,arguments.length),d=0,e=this.types[a].length,f=!0;for(d;e>d;d++){if(b=this.types[a][d],!this.context[b])throw new Error("No callback method found: "+b);if(this.context[b].apply(this.context,c)===!1){f=!1;break}}return f},remove:function(a,b){if(this.types[a]){var c=0,d=this.types[a].length;for(c;d>c;c++)if(b===this.types[a][c]){this.types[a].splice(c,1);break}return this}}},Callbacks.Utils={self:{addCallback:function(a,b){this.prototype.callbacks[a]?!this.prototype.callbacks[a]instanceof Array&&(this.prototype.callbacks[a]=[this.prototype.callbacks[a]]):this.prototype.callbacks[a]=[],this.prototype.callbacks[a].push(b)}},prototype:{callbacks:{},initCallbacks:function(a){this.hasOwnProperty("callbacks")||(this.callbacks=new Callbacks(this)),a&&(this.callbacks.types=a)},destroyCallbacks:function(){this.callbacks&&(this.callbacks.destructor(),this.callbacks=null)}}},dom=window.dom||{},dom.events=dom.events||{},dom.events.Delegator=function(){function a(a,b){var c=a.getAttribute("data-actionparams-"+b)||a.getAttribute("data-actionparams");return a=null,c?JSON.parse(c):{}}function b(){return k.node.ownerDocument}function c(a){return k.actionPrefix?a.replace(/.+?(\w+)$/g,"$1"):a}function d(a,b){var c=b;return k.actionPrefix?(c=b,k.actionPrefix+c!==a?c=null:!k.delegate[c]&&k.delegate.handleAction&&(c="handleAction")):!k.delegate[c]&&k.delegate.handleAction&&(c="handleAction"),c}function e(){this._stopPropagation(),this.propagationStopped=!0}function f(a){return a._stopPropagation||(a._stopPropagation=a.stopPropagation,a.stopPropagation=e,a.propagationStopped=!1,a.stop=function(){this.preventDefault(),this.stopPropagation()},a.actionTarget||(a.actionTarget=a.target||a.srcElement)),a}function g(a){a=f(a||window.event),i(a,a.actionTarget),a=null}function h(a){13===a.keyCode&&g(a),a=null}function i(b,e){var f,g=null,h=null,l=null;if(g=e.getAttribute("data-action-"+b.type)||e.getAttribute("data-action"),g&&(h=c(g),k.actionEventMapping&&k.actionEventMapping[h]!==b.type?h=null:l=d(g,h)),l&&k.delegate[l])try{f=a(e,b.type),k.delegate[l](b,e,f,h)}catch(m){b.preventDefault(),b.stopPropagation(),j(b,e,f,h,l,m)}!b.propagationStopped&&e!==k.node&&e.parentNode?(b.actionTarget=e.parentNode,i(b,b.actionTarget)):(b.actionTarget=null,b.stopPropagation=b._stopPropagation,b._stopPropagation=null,b.propagationStopped=null),b=e=null}function j(a,b,c,d,e,f){if(k.delegate.handleActionError)k.delegate.handleActionError(a,b,{error:f,params:c,method:e},d);else if(k.constructor.errorDelegate)k.constructor.errorDelegate.handleActionError(a,b,{error:f,params:c,method:e},d);else{if(!k.constructor.logger)throw f;k.constructor.logger.warn('An error was thrown while executing method "'+e+'", action "'+d+'", during a "'+a.type+'" event on element '+k.node.nodeName+"."+k.node.className.split(/\s+/g).join(".")+"#"+k.node.id+"."),k.constructor.logger.error(f)}}this.initialize=function(a,b,c){this.actionPrefix=null,this.eventTypes=[],this.eventTypesAdded={},this.eventActionMapping=null,this.actionEventMapping=null,this.delegate=a||null,this.node=b||null,c&&this.setActionPrefix(c)},this.destructor=function(){this.node&&(this.removeEventTypes(this.eventTypes),this.node=null),this.delegate=k=null},this.init=function(){return"string"==typeof this.node&&(this.node=document.getElementById(this.node)),this},this.addEventListener||(this.addEventListener=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}),this.addEventType=function(a){this.eventTypesAdded[a]||("enterpress"===a?this.addEventListener(this.node,"keypress",h):this.addEventListener(this.node,a,g),this.eventTypes.push(a),this.eventTypesAdded[a]=!0)},this.addEventTypes=function(a){var b=0,c=a.length;for(b;c>b;++b)this.addEventType(a[b])},this.removeEventListener||(this.removeEventListener=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)}),this.removeEventType=function(a){this.eventTypesAdded[a]&&("enterpress"===a?this.removeEventListener(this.node,"keypress",h):this.removeEventListener(this.node,a,g),this.eventTypesAdded[a]=!1)},this.removeEventTypes=function(a){var b=0,c=a.length;for(b;c>b;++b)this.removeEventType(a[b])},this.setActionPrefix=function(a){a.match(/\.$/)||(a+="."),this.actionPrefix=a},this.setEventActionMapping=function(a){var b,c,d;if(this.eventActionMapping)for(b in this.eventActionMapping)this.eventActionMapping.hasOwnProperty(b)&&this.removeEventType(b);this.actionEventMapping={};for(b in a)if(a.hasOwnProperty(b))for(this.addEventType(b),a[b]=a[b]instanceof Array?a[b]:[a[b]],c=0,d=a[b].length;d>c;c++)this.actionEventMapping[a[b][c]]=b;this.eventActionMapping=a,a=null},this.triggerEvent||(this.triggerEvent=function(a){var c=b().createEvent("CustomEvent");c.initCustomEvent(a,!0,!1,null),this.node.dispatchEvent(c),c=null});var k=this;this.node=null,this.eventTypes=null,this.eventTypesAdded=null,this.delegate=null,this.constructor=dom.events.Delegator,this.getActionParams=a,this.getMethodFromAction=d,this.handleActionError=j,this.handleEvent=g,this.handlePatchedEvent=i,this.initialize.apply(this,arguments)},dom.events.Delegator.logger=window.console||null,dom.events.Delegator.errorDelegate=null,ElementStore.prototype={_cache:null,config:null,_document:null,returnNative:!1,_root:null,constructor:ElementStore,init:function(a){if(!a)throw new Error("Missing required argument: root");return this.config=this.config||{elements:{},collections:{}},this._cache={},this.setRoot(a),this.createElement||(this.createElement=this._createElement),this.parseHTML||(this.parseHTML=this._parseHTML),this.querySelector||(this.querySelector=this._querySelector),this.querySelectorAll||(this.querySelectorAll=this._querySelectorAll),this.eagerLoad(),this},destructor:function(){this._cache&&(this.clearCache(),this._cache=null),this.config=this._root=this._document=null},clearCache:function(){var a;for(a in this._cache)this._cache.hasOwnProperty(a)&&(this._cache[a]=null);return this},_createElement:function(a){return this._document.createElement(a)},eagerLoad:function(){var a,b;for(a in this.config.elements)this.config.elements.hasOwnProperty(a)&&(b=this.config.elements[a],b.eager&&!b.nocache&&(this._cache[a]=this.getElement(a)));for(a in this.config.collections)this.config.collections.hasOwnProperty(a)&&(b=this.config.collections[a],b.eager&&!b.nocache&&this.getCollection(a));return this},get:function(a){return this.getElement(a)||this.getCollection(a)||null},getCollection:function(a){var b;if(this.config.collections[a])if(this._cache[a])b=this._cache[a];else{if(!this.config.collections[a].selector)throw new Error('Missing required config "selector" for collection '+a);b=this.querySelectorAll(this.config.collections[a].selector),this.config.collections[a].nocache||(this._cache[a]=b)}else b=null;return b},getElement:function(a){var b;if(this.config.elements[a])if(this._cache[a])b=this._cache[a];else{if(!this.config.elements[a].selector)throw new Error('Missing required config "selector" for element '+a);b=this.querySelector(this.config.elements[a].selector),this.config.elements[a].nocache||(this._cache[a]=b)}else b=null;return b},isCollection:function(a){return this.config.collections.hasOwnProperty(a)},isElement:function(a){return this.config.elements.hasOwnProperty(a)},keys:function a(){var b,a=[];for(b in this.config.elements)this.config.elements.hasOwnProperty(b)&&a.push(b);for(b in this.config.collections)this.config.collections.hasOwnProperty(b)&&a.push(b);return a},_mergeConfigs:function(a,b,c){for(key in b)!b.hasOwnProperty(key)||void 0!==a[key]&&c||(a[key]=b[key])},_parseHTML:function(a){a=a.replace(/^\s+|\s+$/g,"");var b=this.createElement("div");b.innerHTML=a;for(var c=[],d=b.childNodes.length;d--;)c.push(b.childNodes[d]),b.removeChild(b.childNodes[d]);return b=null,c},setConfig:function(a,b){return this.config=this.config||{elements:{},collections:{}},a.elements&&this._mergeConfigs(this.config.elements,a.elements,b),a.collections&&this._mergeConfigs(this.config.collections,a.collections,b),this},setRoot:function(a){return this.clearCache(),this._root=a,this._document="#document"===this._root.nodeName?this._root:this._root.ownerDocument,this},toString:function(){return"[object ElementStore]"},_querySelector:function(a,b){return(b||this._root).querySelector(a)},_querySelectorAll:function(a,b){return(b||this._root).querySelectorAll(a)}},ElementStore.Utils={prototype:{elementStore:{},destroyElementStore:function(){this.elementStore&&(this.elementStore.destructor(),this.elementStore=null)},initElementStore:function(a){this.hasOwnProperty("elementStore")||(this.elementStore=new ElementStore),this._compileElementStore(),this._initGetters(),this.elementStore.init(a)},_initGetters:function(){if(!this.__proto__.hasOwnProperty("__elementStoreGettersCreated__")){var a,b,c=this.__proto__,d=this.elementStore.config.elements,e=this.elementStore.config.collections;this.createElementGetter||(this.createElementGetter=this._createElementGetter),this.createCollectionGetter||(this.createCollectionGetter=this._createCollectionGetter);for(a in d)if(d.hasOwnProperty(a)){if(c[a]){if(c[a+"Element"])throw new Error("Cannot create element getter: "+a);b=a+"Element"}else b=a;this.createElementGetter(a,b)}for(a in e)if(e.hasOwnProperty(a)){if(c[a]){if(c[a+"Collection"])throw new Error("Cannot create collection getter: "+a);b=a+"Collection"}else b=a;this.createCollectionGetter(a,b)}c.__elementStoreGettersCreated__=!0,d=e=c=null}},clearElementStoreCache:function(){this.elementStore.clearCache()},collection:function(a){return this.elementStore.getCollection(a)},_compileElementStore:function(){if(this.__proto__.hasOwnProperty("_compiledElementStore"))return this.elementStore.setConfig(this.__proto__._compiledElementStore),void 0;for(var a=this.__proto__;a;)a.hasOwnProperty("elementStore")&&this.elementStore.setConfig(a.elementStore,!0),a=a.__proto__;this.__proto__._compiledElementStore=this.elementStore.config},_createCollectionGetter:function(a,b){var c=function(){return this.elementStore.getCollection(a)};this.__proto__[b]=c},_createElementGetter:function(a,b){var c=function(){return this.elementStore.getElement(a)};this.__proto__[b]=c},element:function(a){return this.elementStore.getElement(a)}}},function(){function a(a,c){c.self&&b(c.self,a,!0),c.prototype&&b(c.prototype,a.prototype,!0),c.included&&c.included(a)}function b(a,b,c){var d,e;for(d in a)!a.hasOwnProperty(d)||c&&b[d]!==e||(b[d]=a[d]);a=b=null}var c={setup:function(b){c.ApplicationEvents&&(a(b,c.ApplicationEvents),c.Notifications&&a(b,c.Notifications))}};window.Beacon=c}(),Beacon=function(a){function b(){this._subscribers={}}return b.prototype={_subscribers:null,constructor:b,destructor:function(){if(this._subscribers){var a,b,c,d,e=this._subscribers;for(b in e)if(e.hasOwnProperty(b)){for(c=0,d=e[b].length;d>c;c++)a=e[b][c],a.callback=a.context=null;e[b]=null}a=e=this._subscribers=null}},_dispatchEvent:function(a,b,c){var d,e,f=0,g=c.length;for(f;g>f&&(d=c[f],"function"===d.type?e=d.callback.call(d.context,a,b):"string"===d.type&&(e=d.context[d.callback](a,b)),e!==!1);f++);return c=d=a=b=null,e!==!1},publish:function(a,b,c){if(!this._subscribers[a])return!0;var d=this._dispatchEvent(b,c,this._subscribers[a]);return b=c=null,d},subscribe:function(a,b,c){var d=typeof b,e=typeof c;if(this._subscribers[a]=this._subscribers[a]||[],"function"===d)this._subscribers[a].push({context:null,callback:b,type:"function"});else if("object"===d){if("string"===e&&"function"!=typeof b[c])throw new Error("Cannot subscribe to "+a+" because "+c+" is not a function");this._subscribers[a].push({context:b||null,callback:c,type:e})}},unsubscribe:function(a,b,c){if(this._subscribers[a]){var d,e=typeof b,f=typeof c,g=this._subscribers[a],h=g.length;for("function"===e?(c=b,b=null,f="function"):"object"===e&&"undefined"===f&&(f="any");h--;)d=g[h],("any"===f&&d.context===b||d.type===f&&d.context===b&&d.callback===c)&&g.splice(h,1);g=d=null}b=c=null},unsubscribeAll:function(a){var b,c,d;for(b in this._subscribers)if(this._subscribers.hasOwnProperty(b))for(d=this._subscribers[b],c=d.length;c--;)d[c].context===a&&d.splice(c,1);a=d=null}},a.Dispatcher=b,a}(window.Beacon||{}),Beacon=function(a){var b={eventDispatcher:null,self:{getEventDispatcher:function(){return a.ApplicationEvents.eventDispatcher||(a.ApplicationEvents.eventDispatcher=new a.Dispatcher),a.ApplicationEvents.eventDispatcher},publish:function(a,b,c){return this.getEventDispatcher().publish(a,b,c)},subscribe:function(a,b,c){this.getEventDispatcher().subscribe(a,b,c)},unsubscribe:function(a,b,c){this.getEventDispatcher().unsubscribe(a,b,c)}},prototype:{eventDispatcher:null,_initApplicationEvents:function(){this.hasOwnProperty("eventDispatcher")||(this.eventDispatcher=this.constructor.getEventDispatcher())},_destroyApplicationEvents:function(){this.eventDispatcher&&this.eventDispatcher.unsubscribe(this)},publish:function(a,b){return this.eventDispatcher.publish(a,this,b)},subscribe:function(a,b,c){return this.eventDispatcher.subscribe(a,b,c),this},unsubscribe:function(a,b,c){return this.eventDispatcher.unsubscribe(a,b,c),this}}};return a.ApplicationEvents=b,a}(window.Beacon||{}),Beacon=function(a){var b=0,c={self:{addNotifications:function(a){var b,c=this.prototype.notifications||{};for(b in a)a.hasOwnProperty(b)&&(c[b]=c[b]?c[b]instanceof Array?c[b]:[c[b]]:[],c[b].push(a[b]));this.prototype.notifications=c,c=a=null}},prototype:{_notificationDispatcher:null,_notificationId:null,_notificationIdPrefix:"notifications",notifications:null,_initNotifications:function(){this.__proto__.hasOwnProperty("_compiledNotifications")||this._compileNotifications(),this._initApplicationEvents(),this._notificationId=b++;var a,c,d,e;for(a in this._compiledNotifications)if(this._compiledNotifications.hasOwnProperty(a))for(e=this._compiledNotifications[a],c=0,d=e.length;d>c;c++)this.listen(a,this,e[c]);this._setUpNotifications()},_compileNotifications:function(){for(var a,b,c,d={},e=this.__proto__;e;){if(e.hasOwnProperty("notifications")&&e.notifications){c=e.notifications;for(a in c)if(c.hasOwnProperty(a))for(d[a]=d[a]||[],c[a]=c[a]instanceof Array?c[a]:[c[a]],b=c[a].length;b--;)d[a].unshift(c[a][b])}e=e.__proto__}this.__proto__._compiledNotifications=d,e=c=d=null},_destroyNotifications:function(){this._notificationDispatcher&&(this._notificationDispatcher.destructor(),this._notificationDispatcher=null)},_setUpNotifications:function(){},notify:function(a,b){var c=this.publish(this._notificationIdPrefix+"."+this._notificationId+"."+a,b);return b=null,c},listen:function(a,b,c){return this.subscribe(this._notificationIdPrefix+"."+this._notificationId+"."+a,b,c),b=c=null,this},ignore:function(a,b,c){return this.unsubscribe(this._notificationIdPrefix+"."+this._notificationId+"."+a,b,c),b=c=null,this}}};return a.Notifications=c,a}(window.Beacon||{}),Hash.prototype={constructor:Hash,destructor:function(){for(var a in this)this.exists(a)&&(this[a]=null)},empty:function(){var a,b=this.keys(),c=0,d=b.length;for(c;d>c;c++)a=b[c],this[a]=null,delete this[a];return this},exists:function(a){return!this.isReserved(a)&&this.hasOwnProperty(a)?!0:!1},filter:function(a,b){b=b||this;var c=new Hash;for(var d in this)this.exists(d)&&a.call(b,d,this[d])&&c.set(d,this[d]);return c},forEach:function(a,b){b=b||this;for(var c in this)if(this.exists(c)&&a.call(b,c,this[c])===!1)break;return a=b=null,this},get:function(a){if(this.isReserved(a))throw new Error("Cannot get reserved property: "+a);return this.hasOwnProperty(a)?this[a]:null},isEmpty:function(){return 0===this.size()},isReserved:function(a){return this.constructor.prototype.hasOwnProperty(a)},keys:function b(){var b=[];for(var a in this)this.exists(a)&&b.push(a);return b},merge:function(a,b){if(!a)throw new Error("Missing required argument: overrides");var c,d,e,f,g;for(c in a)if(a.hasOwnProperty(c))if(e=this[c],d=a[c])if(d.constructor===Array&&e&&e.constructor===Array&&!this.isReserved(c))for(f=0,g=d.length;g>f;f++)e.push(d[f]);else e&&e.constructor===Hash&&!this.isReserved(c)?e.merge(d):this.exists(c)&&b||this.set(c,a[c]);else this.exists(c)&&b||this.set(c,d);return this},safeMerge:function(a){this.merge(a,!0)},set:function(a,b){if(this.isReserved(a))throw new Error("Cannot set reserved property: "+a);return this[a]=b,this},size:function(){return this.keys().length},toString:function(){return"[object Hash]"}},function(g){function Hypodermic(a){a=a||{},a[this.constructor.me]={className:this.constructor.className,singleton:!0},this._configs=a,this._singletons={},this._singletons[this.constructor.me]=this,a=null}Hypodermic.me="objectFactory",Hypodermic.className="Hypodermic",Hypodermic.prototype={_configs:null,_singletons:null,destructor:function(){this._destroySingletons(),this.configs=this.classReferenceCache=null},_destroySingletons:function(){for(var a in this.singletons)this.singletons.hasOwnProperty(a)&&(this.singletons[a]=null);this.singletons=null},_capitalize:function(a){return a.charAt(0).toUpperCase()+a.substring(1,a.length)},_createInstanceFromConfig:function(a){if(!a.className)throw new Error("Missing required className for instance configuration");var b=null,c=this._getClassReference(a.className),d=null,e=null,f=null;if(!c)throw new Error('Failed to create instance. Class "'+a.className+'" was not found');if("[object Function]"===Object.prototype.toString.call(c)?a.constructorArgs?(d=function(){},d.prototype=c.prototype,b=new d,e=this._getConstructorArgs(a.constructorArgs),c.apply(b,e)):b=new c:b=c,a.parent)for(f=this._configs[a.parent];f;)f.properties&&this._injectDependencies(b,f.properties),f=this._configs[f.parent]||null;return a.properties&&this._injectDependencies(b,a.properties),d=null,c=null,a=null,f=null,b},_getClassReference:function(className){var Klass=_classCache[className]||null;if(!Klass&&/^[a-zA-Z][\w.$]+$/.test(className))try{Klass=eval(className)}catch(error){Klass=null}return Klass&&(_classCache[className]=Klass),Klass},_getConstructorArgs:function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(this._getDependencyValue(a[c]));return b},_getDependencyValue:function(a){var b=null;if(a.id)b=this.getInstance(a.id);else{if("undefined"==typeof a.value)throw new Error('Cannot extract dependency value. Property config missing one of "id" or "value"');b=a.value}return a=null,b},getInstance:function(a){var b=this._configs[a],c=null;if(b)if(b.singleton)c=this._getSingletonInstance(a,b);else{if(b.abstract)throw new Error('Cannot instantiate an object from abstract config "'+a+'"');c=this._createInstanceFromConfig(b)}else c=null;return c},_getSingletonInstance:function(a,b){var c=null;return this._singletons[a]?c=this._singletons[a]:(c=this._createInstanceFromConfig(b),this._singletons[a]=c),c},_injectDependencies:function(a,b){var c="",d="",e="",f=null;for(e in b)b.hasOwnProperty(e)&&(f=this._getDependencyValue(b[e]),c="set"+this._capitalize(e),d="add"+this._capitalize(e),this._isFunction(a[c])?a[c](f):this._isFunction(a[d])?a[d](f):a[e]=f);b=a=f=null},_isArray:function(a){return a instanceof Array?!0:!1},_isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)?!0:!1},_isObject:function(a){return a instanceof Object?!0:!1},setConfigs:function(a){for(var b in a)a.hasOwnProperty(b)&&(this._configs[b]=a[b]);a=null}},Hypodermic.prototype.constructor=Hypodermic,Hypodermic.precacheClasses=function(a){for(var b in a)a.hasOwnProperty(b)&&!_classCache.hasOwnProperty(b)&&(_classCache[b]=a[b])};var _classCache={Array:g.Array,Boolean:g.Boolean,Date:g.Date,Error:g.Error,Function:g.Function,Hypodermic:Hypodermic,Number:g.Number,Object:g.Object,RegExp:g.RegExp,String:g.String};!function(){for(var a,b=["XMLHttpRequest","FileReader","DOMParser","DocumentFragment"],c=0,d=b.length;d>c;c++)a=b[c],void 0!==g[a]&&(_classCache[a]=g[a])}(),g.Hypodermic=Hypodermic}("undefined"!=typeof global?global:window),Reaper.prototype={allowNulls:!1,flat:!0,nestedKeysRegex:/[.\[\]]+/g,constructor:Reaper,_extractFieldValues:function(a,b){var c,d,e=0,f=a.length;for(e;f>e;e++)c=this._extractValue(a[e]),d=a[e].name,this._setValue(b,d,c)},_extractValue:function(a){var b,c,d=a.nodeName.toLowerCase(),e=null;if(!a.disabled)if("input"===d)"checkbox"===a.type||"radio"===a.type?a.checked&&(e=a.value):e=a.value;else if("select"===d)if(a.multiple)for(e=[],b=0,c=a.options.length;c>b;++b)!a.options[b].disabled&&a.options[b].selected&&a.options[b].value&&e.push(a.options[b].value);else e=a.value;else e=a.value;return a=null,""===e?null:e},getData:function(a,b){if(!a)throw new Error("Missing required argument: element");b=b||{};var c=a.getElementsByTagName("input"),d=a.getElementsByTagName("select"),e=a.getElementsByTagName("textarea");return this._extractFieldValues(c,b),this._extractFieldValues(d,b),this._extractFieldValues(e,b),a=c=d=e=null,b},_setNestedValue:function(a,b,c){var d,e=a,f=0,g=b.length-1,h=b[g];for(f;g>f;f++)d=b[f],e.hasOwnProperty(d)||(e[d]={}),e=e[d];e[h]=c,e=b=null},_setValue:function(a,b,c){if(this.flat)(null!==c||this.allowNulls)&&(a[b]=c);else if(null!==c||this.allowNulls){var d=b.replace(/\]$/,"").split(this.nestedKeysRegex);this._setNestedValue(a,d,c)}}},function(a){var b=0,c=Object.extend({includes:[Callbacks.Utils,Beacon.ApplicationEvents,Beacon.Notifications,ElementStore.Utils],self:{manager:null,getManager:function(){return c.manager},unregister:function(a){c.manager&&c.manager.unregisterModule(a)}},prototype:{actions:{click:["cancel"]},callbacks:{afterReady:["_loaded"]},delegator:null,document:null,element:null,elementStore:{},guid:null,options:{actionPrefix:null,defaultModule:!1},window:null,initialize:function(){this.guid=b++},init:function(a,b){return a&&this.setElement(a),this.document=this.element.ownerDocument,this.window=this.document.defaultView||this.document.parentWindow,this.hasOwnProperty("options")||(this.options=new Hash),this._initOptions(this.options),b&&this.options.merge(b),this.delegator||(this.delegator=new dom.events.Delegator),this.delegator.delegate=this,this.delegator.node=this.element,this.options.actionPrefix&&this.delegator.setActionPrefix(this.options.actionPrefix),this.delegator.init(),this._initActions(),this._initCallbacks(),this._initNotifications(),this.initElementStore(this.element),this.callbacks.execute("beforeReady"),this._ready(),this.callbacks.execute("afterReady"),this.options.defaultModule&&this.constructor.getManager().setDefaultModule(this),this},destructor:function(a){this.callbacks.execute("beforeDestroy"),this.constructor.unregister(this),this.destroyElementStore(),this.destroyCallbacks(),this.delegator&&this.delegator.destructor(),!a&&this.element&&this.element.parentNode.removeChild(this.element),this.options&&this.options.destructor(),this.actions=this.element=this.delegator=this.options=this.document=this.window=null},cancel:function(a,b,c){a.stop(),this.destructor(),a=b=c=null},focus:function(a){var b,c=this.element.getElementsByTagName("*"),d=0,e=c.length;if(a){for(d;e>d;d++)if(b=c[d],"A"===b.tagName||"BUTTON"===b.tagName||"TEXTAREA"===b.tagName||"SELECT"===b.tagName||"INPUT"===b.tagName&&"hidden"!==b.type){b.focus&&b.focus(),b.select&&b.select();break}}else for(d;e>d;d++)if(b=c[d],"TEXTAREA"===b.tagName||"SELECT"===b.tagName||"INPUT"===b.tagName&&"hidden"!==b.type){b.focus&&b.focus(),b.select&&b.select();break}},_ready:function(){},_initActions:function(){for(var a=new Hash,b=this.__proto__;b;)b.hasOwnProperty("actions")&&a.safeMerge(b.actions),b=b.__proto__;this.delegator.setEventActionMapping(a)},_initCallbacks:function(){for(var a=new Hash,b=this.__proto__;b;)b.hasOwnProperty("callbacks")&&a.safeMerge(b.callbacks),b=b.__proto__;this.initCallbacks(a)},_initOptions:function(){for(var a=this.__proto__;a;)a.hasOwnProperty("options")&&this.options.safeMerge(a.options),a=a.__proto__},_loading:function(a){a=a||this.element,a.className+=" loading",a=null},_loaded:function(a){a=a||this.element,a.className=a.className.replace(/(^|\s+)(loading)(\s+|$)/,"$1$3").replace(/[\s]{2,}/g," "),a=null},setElement:function(a){if(this.element="string"==typeof a?document.getElementById(a):a,!this.element)throw new Error("Could not find element: "+a)},setOptions:function(a){this.hasOwnProperty("options")?this.options.merge(a):this.options=new Hash(a)}}});a.Module=c}(window),Module.FormModule=Module.extend({prototype:{actions:{enterpress:["submit"],submit:["submit"]},callbacks:{beforeReady:["initExtractor","initSerializerFactory"]},extractor:null,options:{"extractor.allowNulls":!1,"extractor.flat":!1},serializerFactory:null,initExtractor:function(){this.extractor=this.extractor||new Reaper,this.extractor.allowNulls=this.options["extractor.allowNulls"],this.extractor.flat=this.options["extractor.flat"]},initSerializerFactory:function(){this.serializerFactory=this.serializerFactory||Cerealizer},_afterSubmit:function(a){a=null},_beforeSubmit:function(a,b,c,d){return a=b=c=d=null,!0},_getData:function(){return this.extractor.getData(this.element)},_getTransport:function(){return new XMLHttpRequest},_sendRequest:function(a){var b=this._getTransport(),c=this.element.getElementsByTagName("form")[0]||this.element,d=(c.getAttribute("method")||c.getAttribute("data-form-method")||"POST").toUpperCase(),e=c.getAttribute("action")||c.getAttribute("data-form-action"),f=c.getAttribute("enctype")||c.getAttribute("data-form-enctype")||"queryString",g=this,h=this.serializerFactory.getInstance(f),i=h.serialize(a);if(!e)throw new Error("Missing required attribute: action or data-form-action");var j=function(){4===this.readyState&&(this.status<300||this.status>399)&&(g.element.innerHTML=this.responseText,k())},k=function(){g._loaded(),g._afterSubmit(b),g=a=event=element=i=b=b.onreadystatechange=c=null};"GET"===d&&(e+=/\?/.test(e)?i:"?"+i,i=null),b.open(d,e,!0),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),f&&b.setRequestHeader("Content-Type",f),this._loading(),b.onreadystatechange=j,b.send(i)},submit:function(a,b,c){a.stop();
var d=this._getData();this._beforeSubmit(d,a,b,c)&&this._sendRequest(d)}}}),function(Module){function Factory(){}Factory.prototype={objectFactory:null,constructor:Module.Factory,destructor:function(){this.objectFactory=null},createInstance:function(a,b,c){var d=this.getInstance(b);return d.init(a,c),d},getInstance:function getInstance(type){var instance=null,Klass=null;if(this.objectFactory){if(instance=this.objectFactory.getInstance(type),!instance)throw new Error("The object factory failed to get a new instance for type: "+type)}else{if(!/^[a-zA-Z][a-zA-Z0-9.]+[a-zA-Z0-9]$/.test(type))throw new Error("Cannot instantiate invalid type: "+type);try{Klass=eval(type)}catch(error){throw new Error("Class name "+type+" does not exist")}if(!Klass)throw new Error("Class name "+type+" does not exist");if("function"!=typeof Klass)throw new Error("Class name "+type+" is not a constructor function");instance=new Klass}return instance}},Module.Factory=Factory}(window.Module||{}),function(){function a(a){this.options=null,this.types=[],a&&this.setElement(a)}a.prototype={element:null,options:null,types:null,constructor:a,forEach:function(a,b){var c,d,e,f=0,g=this.types.length;if(1===g)a.call(b,this.element,this.types[0],this.options,0,this);else for(f;g>f&&(d=this.types[f],e=this.options[d]||{},c=a.call(b,this.element,d,e,f,this),c!==!1);++f);},setElement:function(a){this.element=a;var b=a.getAttribute("data-modules"),c=a.getAttribute("data-module-options");if(!b)throw new Error("Missing required attribute data-modules on "+a.nodeName+"."+a.className.split(/\s+/g).join(".")+"#"+a.id);this.types=b.replace(/^\s+|\s+$/g,"").split(/\s+/g),this.options=c?JSON.parse(c):{}}},Module.MetaData=a}(window.Module||{}),function(a){function b(){}b.prototype={factory:null,manager:null,constructor:b,destructor:function(a){a&&this.factory&&this.factory.destructor(),this.factory=this.manager=null},_createModuleClass:function(a){return"module "+a.charAt(0).toLowerCase()+a.slice(1,a.length).replace(/(\.[A-Z])/g,function(a,b){return"-"+b.replace(/\./g,"").toLowerCase()}).replace(/Module$/,"").replace(/^\s+|\s+$/g,"")},createModule:function(a,b,c){var d=this.factory.getInstance(b),e=this._createModuleClass(b);return a.className+=a.className?" "+e:e,d.setElement(a),d.setOptions(c),c.defaultModule&&this.manager.setDefaultModule(d),d},createModules:function(a,b,c){var d,e=[],b=b||function(){};return a.forEach(function(a,f,g){d=this.createModule(a,f,g),e.push(d),b.call(c,d,a,f,g)},this),b=c=d=null,e}},a.Provider=b}(window.Module||{}),function(a){function b(){}b.prototype={baseClassName:"module",defaultModule:null,defaultModuleFocused:!1,provider:null,registry:null,groups:null,constructor:a.Manager,destructor:function(b){a.manager===this&&(a.manager=null),this.registry&&this._destroyRegistry(b),this.groups&&this._destroyGroups(),this.provider&&(b&&this.provider.destructor(),this.provider=null)},_destroyGroups:function(){var a,b,c,d;for(a in this.groups)if(this.groups.hasOwnProperty(a)){for(b=this.groups[a],c=0,d=b.length;d>c;c++)b[c]=null;this.groups[a]=null}this.groups=null},_destroyRegistry:function(a){var b,c;for(b in this.registry)this.registry.hasOwnProperty(b)&&(c=this.registry[b],a&&c.module.destructor(!0),c.module=null,this.registry[b]=null);this.registry=null},init:function(){return this.provider=this.provider||new a.Provider,this.provider.factory=this.provider.factory||new a.Factory,this.provider.manager=this,this.registry=this.registry||{},this.groups=this.groups||{},a.manager=this,this},eagerLoadModules:function(a){var b,c=a.getElementsByTagName("*"),d=0,e=c.length;for(d;e>d;d++)b=c[d],b.getAttribute("data-modules")&&!b.getAttribute("data-module-lazyload")&&this.createModules(b);return c=null,this},createModule:function(a,b,c,d){var e=this.provider.createModule(a,b,c);return d&&this.registerModule(b,e),a=c=null,e},createModules:function(b){if(!b)throw new Error("Missing required argument: element");var c=new a.MetaData(b);this.provider.createModules(c,function(a,b,c){this.registerModule(c,a),a.init()},this),this.markModulesCreated(b,c),c=b=null},focusDefaultModule:function(a){this.defaultModule&&!this.defaultModuleFocused&&(this.defaultModuleFocused=!0,this.defaultModule.focus(a))},initModuleInContainer:function(a,b,c,d,e,f){var g=new Date,h=new Hash({guid:f.guid,createdAt:g,timestamp:g.getTime()});c.renderData&&h.merge(c.renderData);var i=d.innerHTML.replace(/#\{([-.\w]+)\}/g,function(a,b){return h[b]||""});a.className+=(" "+this.baseClassName+" "+c.className).replace(/\s{2,}/g," "),a.innerHTML=i,"top"===c.insert&&b.firstChild?b.insertBefore(a,b.firstChild):b.appendChild(a),this.registerModule(e,f),f.init()},markModulesCreated:function(a,b){a.setAttribute("data-modules-created",b.types.join(" ")),a.removeAttribute("data-modules"),a=b=null},registerModule:function(a,b){if(void 0===b.guid||null===b.guid)throw new Error("Cannot register module "+a+" without a guid property");if(this.registry[b.guid])throw new Error("Module "+b.guid+" has already been registered");this.registry[b.guid]={module:b,type:a},this.groups[a]||(this.groups[a]=[]),this.groups[a].push(b),b=null},unregisterModule:function(a){if(!a.guid||!this.registry[a.guid])return a=null,void 0;var b=a.guid,c=this.registry[b].type,d=this.groups[c];if(this.registry[b].module=null,this.registry[b]=null,delete this.registry[b],d)for(var e=0,f=d.length;f>e;e++)if(d[e]===a){d.splice(e,1);break}a=d=null},setDefaultModule:function(a){this.defaultModule||(this.defaultModule=a),a=null}},a.Manager=b}(window.Module||{}),Module.Manager.LazyLoader={prototype:{lazyLoadModules:function c(a,b){function d(){q.stopLazyLoadingModules&&q.stopLazyLoadingModules(),b&&p.merge(b),g(),h(),s.scrollTop||s.scrollLeft||(s=null)}function e(){return t&&(n(),t=u=s=null),r&&(clearTimeout(r),r=null),p&&(p.destructor(),p=null),q.stopLazyLoadingModules=q=null,this}function f(a,b,c){a.addEventListener?a.addEventListener(b,c,!0):"scroll"===b?a.onscroll=c:a.attachEvent("on"+b,c)}function g(){f(t,"mouseover",j),f(u,"scroll",k)}function h(){var a,b,d=t.getElementsByTagName("*"),e=o.create(i());for(a=0;a<d.length;a++)b=d[a],b.getAttribute("data-module-lazyload")&&e.isVisible(b)&&c(b,"scrollto")}function i(){return null===s&&(s=u.body.scrollTop||u.body.scrollLeft?u.body:u.documentElement),s}function j(a){a=a||window.event,a.target=a.target||a.srcElement,a.target.getAttribute("data-module-lazyload")&&c(a.target,a.type)}function k(){m(u,"scroll",k),r&&clearInterval(r),r=setInterval(l,p.scrollTimeout)}function l(){var a=i(),b=a.scrollLeft,c=a.scrollTop;(b!=v||c!=w)&&(clearInterval(r),f(u,"scroll",k),v=b,w=c,h())}function c(a,b){var c=a.getAttribute("data-module-lazyload");("any"===c||new RegExp(b).test(c))&&(a.removeAttribute("data-module-lazyload"),q.createModules(a),a.setAttribute("data-module-lazyloaded",c)),a=null}function m(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!0):"scroll"===b?a.onscroll=null:a.detachEvent("on"+b,c)}function n(){m(t,"mouseover",j),m(u,"scroll",k)}function o(){}var p=new Hash({scrollElement:null,scrollStopDelay:400,scrollTimeout:250}),q=this,r=null,s=p.scrollElement||null,t=a,u=t.ownerDocument,v=0,w=0;return o.prototype={bottom:0,height:0,left:0,right:0,top:0,width:0,constructor:o,isBottomInBounds:function(a){return a.top+a.height<=this.top+this.height&&a.top+a.height>this.top?!0:!1},isLeftInBounds:function(a){return a.left>=this.left&&a.left<this.left+this.width?!0:!1},isRightInBounds:function(a){return a.left+a.width<=this.left+this.width&&a.left+a.width>this.left?!0:!1},isTopInBounds:function(a){return a.top>=this.top&&a.top<this.top+this.height?!0:!1},isVisible:function(a){var b=!1,c=this._getPosition(a);return(this.isRightInBounds(c)||this.isLeftInBounds(c))&&(this.isTopInBounds(c)||this.isBottomInBounds(c))&&(b=!0),b},_getPosition:function(a){for(var b=a.offsetParent,c={top:a.offsetTop,left:a.offsetLeft,width:a.offsetWidth,height:a.offsetHeight};b=b.offsetParent;)c.top+=b.offsetTop,c.left+=b.offsetLeft;return c}},o.create=function(a){var b=new this;return b.top=a.scrollTop,b.left=a.scrollLeft,b.width=a.clientWidth,b.height=a.clientHeight,b.right=a.offsetWidth-(b.left+b.width),b.bottom=a.offsetHeight-b.top-b.height,b},d(),this.stopLazyLoadingModules=e,this}}},Module.Manager.include(Module.Manager.LazyLoader),Module.Manager.SubModuleProperties={included:function(a){a.addCallback&&a.addCallback("beforeReady","initSubModules")},prototype:{initSubModules:function(){if(!this.options.subModulesDisabled){this.elementStore.setConfig({collections:{subModules:{selector:"[data-module-property]",nocache:!0}}});var a,b=this.elementStore.getCollection("subModules"),c=0,d=b.length;for(c;d>c;c++)a=b[c].getAttribute("data-module-property"),this._createSubModuleProperty(a,b[c])}},_createSubModuleProperty:function(a,b){if(!a)throw new Error("Missing required argument: name");if(!b)throw new Error("Missing required argument: element");var c,d=this.constructor.getManager(),e=new Module.MetaData(b),f=this.constructor.prototype;if(e.types.length>1)throw new Error("Sub module elements cannot have more than one type specified in data-modules");if(c=d.createModule(b,e.types[0],e.options),c.setElement(b),c.init(),null===f[a]){if(this.hasOwnProperty(a))throw new Error("Error creating sub module. Property "+a+" already exists.");this[a]=c}else{if(!(f[a]instanceof Array))throw new Error("Cannot create module property "+a+". Property is neither null nor an Array in the class Prototype.");this.hasOwnProperty(a)||(this[a]=[]),this[a].push(c)}d.markModulesCreated(b,e),d=c=e=f=b=null}}},Module.include(Module.Manager.SubModuleProperties);var Foundry={version:"0.0.6"};Foundry.Application=Module.extend({prototype:{actions:{click:["createModule","publishEvent"]},config:null,logger:window.console||null,moduleManager:null,objectFactory:null,options:{actionPrefix:"app",subModulesDisabled:!0,focusAnythingInDefaultModule:!0},destructor:function(){this.moduleManager&&(this.moduleManager.destructor(!0),this.moduleManager=null),this.objectFactory&&(this.objectFactory.destructor(),this.objectFactory=null),this.config.handleApplicationErrors&&(this.window.onerror=null),this.logger=this.config=null,Module.prototype.destructor.call(this,!0)},_ready:function(){Module.prototype._ready.call(this),null===this.delegator.constructor.errorDelegate&&this.config.handleActionErrors&&(this.delegator.constructor.errorDelegate=this),this.config.handleApplicationErrors&&(this.window.onerror=this.handleError.bind(this));try{this.moduleManager.init(),this.config.eagerLoadModules&&this.moduleManager.eagerLoadModules(this.element),this.config.lazyLoadModules&&this.moduleManager.lazyLoadModules(this.element),this.subscribe("application.createModule",this,"handleCreateModule"),this.moduleManager.focusDefaultModule(this.options.focusAnythingInDefaultModule),this.publish("application.ready")}catch(a){if(!this.handleError(a))throw a}},configure:function(a,b){return a.call(b||this,this.config,this),this},createModule:function(a,b,c){a.stop(),this._createModuleFromConfig(c),a=b=c=null},_createModuleFromConfig:function(a){if(!a.module)throw new Error("Missing required config.module");if(!a.module.type)throw new Error("Missing required config.module.type");if(!a.module.template)throw new Error("Missing required config.module.template for type: "+a.module.type);a.module.options=a.module.options||{},a.container=a.container||{},a.container.insert=a.container.insert||"top",a.element=a.element||{},a.element.tag=a.element.tag||"div";var b=null,c=null,d="script[data-template="+a.module.template+"]",e=this.elementStore.querySelector(d),f=this.document.createElement(a.element.tag);if(!e)throw new Error("Failed to find new module template using selector: "+d);if(c=a.container.selector?this.elementStore.querySelector(a.container.selector):this.document.getElementsByTagName("body")[0],!c)throw new Error("Failed to find module container with selector: "+(a.container.selector||"body"));return b=this.moduleManager.createModule(f,a.module.type,a.module.options||{}),this.moduleManager.initModuleInContainer(f,c,a.container,e,a.module.type,b),b.focus(),event=f=a=c=rootElement=null,b},_getErrorObject:function _getErrorObject(errorMessage){var info=errorMessage.match(/^(([A-Za-z_][A-Za-z0-9._]*):)?(.+$)/),error=null,className,message,Klass;if(info)if(className=info[2]||"Error",message=(info[3]||errorMessage).replace(/^\s+|\s+$/g,""),/^[A-Za-z_][A-Za-z0-9._]*$/.test(className))try{Klass=eval(className),error=new Klass(message)}catch(error){throw new Error("Class '"+className+"' is either not found or not an object constructor function")}else error=new Error(message);else error=new Error(message);return error},handleActionError:function(a,b,c){if(!this.logger)throw c.error;this.logger.debug({event:a,element:b,params:c}),this.logger.error(c.error)},handleCreateModule:function(a){return this._createModuleFromConfig(a.data),!1},handleError:function(a){var b="string"==typeof a?this._getErrorObject(a):a;this._handleError(b)},_handleError:function(a){return this.logger?(this.logger.error(a),!0):!1},publishEvent:function(a,b,c){if(!c.event)throw new Error("Missing required argument params.event");a.stop(),this.constructor.publish(c.event,b,c.data||{})}}});