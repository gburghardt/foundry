<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="x-ua-compatible" content="edge">
		<title>Integrating Pollyfills &mdash; Foundry</title>
		<style type="text/css">
			.module {
				background-color: #f0f0f0;
				border: 1px solid #000;
				border-radius: 8px;
				margin: 1em;
				min-height: 2em;
				padding: 0 1em;
			}
		</style>
	</head>
	<body>

		<div class="module"
			data-module-lazyload="any"
			data-modules="ComplexModule"
			data-module-media="screen and (min-width: 1000px)">
			<p>Loading...</p>
		</div>

		<div class="module"
			data-module-lazyload="any"
			data-modules="MiniModule"
			data-module-media="screen and (max-width: 400px)">
			<p>Loading...</p>
		</div>

		<div class="module"
			data-module-lazyload="any"
			data-modules="GoldilocksModule">
			<p>Loading...</p>
		</div>

		<!-- Base Framework -->
		<script type="text/javascript" src="/js/yepnope.1.5.4-min.js"></script>
		<script type="text/javascript" src="/js/foundry/v0.1.1/foundry.concat.js"></script>
		<script type="text/javascript" src="/js/foundry/v0.1.1/pollyfill_promise.js"></script>
		<script type="text/javascript" src="/js/foundry/v0.1.1/pollyfill_promise/yepnope.js"></script>

		<!-- Your Application Files -->
		<script type="text/javascript" src="./complex_module.js"></script>
		<script type="text/javascript" src="./goldilocks_module.js"></script>
		<script type="text/javascript" src="./mini_module.js"></script>

		<script type="text/javascript">

			var app;

			Foundry.pollyfill({
				test: !!window.matchMedia,
				nope: [
					"/js/matchMedia.js",
					"/js/matchMedia.addListener.js"
				]
			})
			.afterAll(function() {
				app = Foundry.run(function(dependencies, options) {
					options.lazyLoadModules = true;
				});
			})
			.start();

		</script>

	</body>
</html>
